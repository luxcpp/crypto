---
title: BLS API
description: BLS12-381 signature function reference
---

# BLS API Reference

## Key Types

### SecretKey

```cpp
class SecretKey {
public:
    static constexpr size_t SIZE = 32;

    // Constructors
    SecretKey();  // Generate random
    static SecretKey from_bytes(std::span<const uint8_t, 32> bytes);

    // Serialization
    std::array<uint8_t, 32> to_bytes() const;

    // Derive public key
    PublicKey public_key() const;
};
```

### PublicKey

```cpp
class PublicKey {
public:
    static constexpr size_t SIZE = 48;
    static constexpr size_t SIZE_UNCOMPRESSED = 96;

    // Constructors
    static PublicKey from_compressed(std::span<const uint8_t, 48> bytes);
    static PublicKey from_uncompressed(std::span<const uint8_t, 96> bytes);

    // Serialization
    std::array<uint8_t, 48> to_compressed() const;
    std::array<uint8_t, 96> to_uncompressed() const;

    // Aggregation
    static PublicKey aggregate(std::span<const PublicKey> keys);
};
```

### Signature

```cpp
class Signature {
public:
    static constexpr size_t SIZE = 96;
    static constexpr size_t SIZE_UNCOMPRESSED = 192;

    // Constructors
    static Signature from_compressed(std::span<const uint8_t, 96> bytes);

    // Serialization
    std::array<uint8_t, 96> to_compressed() const;

    // Aggregation
    static Signature aggregate(std::span<const Signature> sigs);
};
```

## Functions

### bls_keygen

Generate a new BLS key pair.

```cpp
std::pair<SecretKey, PublicKey> bls_keygen();
```

**Returns:** Tuple of (secret key, public key)

**Example:**
```cpp
auto [sk, pk] = lux::crypto::bls_keygen();
```

### bls_sign

Sign a message with a secret key.

```cpp
Signature bls_sign(
    const SecretKey& sk,
    std::span<const uint8_t> message
);
```

**Parameters:**
- `sk` - Secret key
- `message` - Message bytes to sign

**Returns:** BLS signature

**Example:**
```cpp
std::vector<uint8_t> msg = {0x01, 0x02, 0x03};
auto sig = lux::crypto::bls_sign(sk, msg);
```

### bls_verify

Verify a BLS signature.

```cpp
bool bls_verify(
    const PublicKey& pk,
    std::span<const uint8_t> message,
    const Signature& sig
);
```

**Parameters:**
- `pk` - Public key
- `message` - Original message bytes
- `sig` - Signature to verify

**Returns:** `true` if signature is valid

### bls_aggregate

Aggregate multiple signatures into one.

```cpp
Signature bls_aggregate(std::span<const Signature> signatures);
```

**Parameters:**
- `signatures` - Vector of signatures to aggregate

**Returns:** Single aggregated signature

### bls_aggregate_verify

Verify an aggregated signature against multiple public keys and messages.

```cpp
bool bls_aggregate_verify(
    std::span<const PublicKey> public_keys,
    std::span<const std::vector<uint8_t>> messages,
    const Signature& aggregate_sig
);
```

**Parameters:**
- `public_keys` - Vector of public keys
- `messages` - Vector of messages (must match public_keys length)
- `aggregate_sig` - Aggregated signature

**Returns:** `true` if all signatures are valid

### bls_fast_aggregate_verify

Verify an aggregated signature where all signers signed the same message.

```cpp
bool bls_fast_aggregate_verify(
    std::span<const PublicKey> public_keys,
    std::span<const uint8_t> message,
    const Signature& aggregate_sig
);
```

### bls_pop_prove

Generate proof-of-possession for a public key.

```cpp
ProofOfPossession bls_pop_prove(const SecretKey& sk);
```

### bls_pop_verify

Verify proof-of-possession.

```cpp
bool bls_pop_verify(const PublicKey& pk, const ProofOfPossession& pop);
```

## Pairing Operations

### bls_pairing

Compute bilinear pairing.

```cpp
GT bls_pairing(const G1& p, const G2& q);
```

### bls_multi_pairing

Compute product of multiple pairings (Miller loop optimization).

```cpp
GT bls_multi_pairing(
    std::span<const G1> g1_points,
    std::span<const G2> g2_points
);
```

## Hash-to-Curve

### hash_to_g1

Hash arbitrary data to G1 point.

```cpp
G1 hash_to_g1(
    std::span<const uint8_t> message,
    std::string_view dst
);
```

**Parameters:**
- `message` - Data to hash
- `dst` - Domain separation tag

### hash_to_g2

Hash arbitrary data to G2 point.

```cpp
G2 hash_to_g2(
    std::span<const uint8_t> message,
    std::string_view dst
);
```

## C API

```c
// Key generation
int bls_keygen(uint8_t sk_out[32], uint8_t pk_out[48]);

// Signing
int bls_sign(
    const uint8_t sk[32],
    const uint8_t* msg,
    size_t msg_len,
    uint8_t sig_out[96]
);

// Verification
int bls_verify(
    const uint8_t pk[48],
    const uint8_t* msg,
    size_t msg_len,
    const uint8_t sig[96]
);

// Aggregation
int bls_aggregate_signatures(
    const uint8_t* sigs,
    size_t num_sigs,
    uint8_t agg_out[96]
);
```

## Go API

```go
package bls

// KeyGen generates a new BLS key pair
func KeyGen() (SecretKey, PublicKey)

// Sign creates a signature
func Sign(sk SecretKey, msg []byte) Signature

// Verify checks a signature
func Verify(pk PublicKey, msg []byte, sig Signature) bool

// Aggregate combines multiple signatures
func Aggregate(sigs []Signature) Signature

// AggregateVerify verifies an aggregate signature
func AggregateVerify(pks []PublicKey, msgs [][]byte, sig Signature) bool
```
